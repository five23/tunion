<!DOCTYPE html>
<html lang="en">
  <head>
    <title>uni0nsongbook</title>
    <link rel="shortcut icon" href="favicon.ico" />
    <meta charset="utf-8" />
    <meta name="description" content="uni0nsongbook" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
  </head>
  <body
    style="-webkit-user-select: none"
    ondragstart="return false;"
    ondrop="return false;"
  >
    <header>
      <div id="header-panel"></div>
    </header>
    <main id="rack">
      <div class="viewer">
        <div id="view1sel"></div>
        <canvas id="view1crt" width="600" height="300"></canvas>
      </div>
      <div class="controls">
        <div class="vco">
          <div id="vco1pos"></div>        
          <div id="vco1sld"></div>
        </div>        
        <div class="vco">
          <div id="vco2pos"></div>
          <div id="vco2sld"></div>
        </div>
        <div class="vco">
          <div id="vco3pos"></div>
          <div id="vco3sld"></div>        
        </div>
        <div class="vco">
          <div id="vco4pos"></div>
          <div id="vco4sld"></div>
        </div>
    </main>
<div id="editor">var fs = 44100; // Process Sampling Frequency
var fc = 440; // Center frequency
var z1 = 0.998; // K.lpf Filter Pole (for smoothing controller changes)

var omega = (K.TAU * fc) / fs; // Angular frequency

function process(buffer) {
  // Loop through sample buffer
  for (var t = 0; t < buffer.length; ++t) {
    vco1.step = K.lpf(vco1pos._x.value, vco1.step);
    vco1.N = K.lpf(vco1pos._y.value, vco1.N);
    vco1.theta += vco1.step;

    vco2.step = K.lpf(vco2pos._x.value, vco2.step);
    vco2.N = K.lpf(vco2pos._y.value, vco2.N);
    vco2.theta += vco2.step;

    vco3.step = K.lpf(vco3pos._x.value, vco3.step);
    vco3.N = K.lpf(vco3pos._y.value, vco3.N);
    vco3.theta += vco3.step;

    vco4.step = K.lpf(vco4pos._x.value, vco4.step);
    vco4.N = K.lpf(vco4pos._y.value, vco4.N);
    vco4.theta += vco4.step;

    vco1.out = 0.25 * K.sqr12(vco1.theta * omega, vco1.N);
    vco2.out = 0.25 * K.saw12(vco2.theta * omega, vco2.N);
    vco3.out = 0.25 * K.tri12(vco3.theta * omega, vco3.N);
    vco4.out = 0.25 * K.sqr12(vco4.theta * omega, vco4.N);

    buffer[t] = 0.25 * (vco1.out + vco2.out + vco3.out + vco4.out);
  }

  // Return buffer
  return buffer;
}
</div>
</body>
</html>
